# 📄 产品需求文档（PRD）- 详细版

**产品名称**：全球创作者封面 & 海报生成工具
**版本**：V1.0
**作者**：Manus AI
**日期**：2025-08-28

---

## 1. 产品背景

全球创作者生态正经历高速增长，YouTube、Twitch、Spotify、B站、抖音、小红书等平台对高质量封面和海报的需求日益旺盛。然而，许多创作者面临设计能力不足、制作耗时且质量参差不齐的痛点。他们迫切需要一个能够快速生成“一致风格的人设+吸引眼球的封面”的工具，并支持跨平台、多语言的封面需求。

本产品的目标是提供一个简单易用、跨平台的封面 & 海报自动生成工具，旨在帮助创作者快速生成一致风格、高点击率的封面，从而显著减少其在封面制作上的时间和精力投入，并保证品牌形象的一致性。

---

## 2. 产品定位

*   **目标用户**：
    *   全球独立创作者（YouTube、B站、播客、抖音、Twitch等）
    *   MCN 机构 / 自媒体团队
    *   博客作者 / 播客主持人

*   **产品形态**：Web 应用（未来可扩展为Figma/Canva插件）

*   **价值主张**：
    *   显著减少创作者制作封面的时间（预期可节省70%以上）。
    *   确保创作者人设/品牌形象的一致性。
    *   全面支持全球主流平台尺寸及多语言内容生成。

---

## 3. 产品目标（MVP 版本）

MVP版本将聚焦于核心功能，以验证产品价值并快速迭代：

1.  **个性化风格生成**：用户能够上传头像/Logo，系统基于此生成具有一致风格的封面图。
2.  **批量封面输出**：用户输入视频/播客标题后，系统能一次性生成3–6张候选封面图，提供多样化选择。
3.  **局部精细编辑**：支持用户对生成封面图的局部区域进行编辑，如修改背景、表情、服装或文字内容。
4.  **多平台尺寸适配**：内置YouTube、B站、抖音等主流平台的尺寸预设，方便用户直接应用。
5.  **水印标识与导出**：所有输出图片（JPG/PNG格式）将带有AI标识水印，并支持高清下载。

---

## 4. 功能需求 - 详细设计

### 4.1 用户功能模块

#### 4.1.1 注册与登录模块

**功能描述**：提供多种便捷的注册与登录方式，确保用户能够快速安全地访问系统。

*   **邮箱注册/登录**：
    *   用户输入邮箱地址和密码进行注册。
    *   支持邮箱验证码或链接验证。
    *   已注册用户可通过邮箱和密码登录。
    *   提供“忘记密码”功能，支持邮箱找回。
*   **第三方授权登录**：
    *   **Google 登录**：集成Google OAuth 2.0，用户授权后可直接登录。


**数据流**：
1.  用户在前端界面选择注册/登录方式。
2.  前端将用户输入（邮箱/密码）或第三方授权请求发送至后端认证服务。
3.  后端认证服务验证凭据或与第三方认证平台交互。
4.  认证成功后，后端生成并返回用户Token（如JWT）至前端。
5.  前端存储Token，后续请求携带Token进行身份验证。
6.  用户数据（如用户ID、注册时间、登录方式）存储至用户数据库。

#### 4.1.2 封面生成模块

**功能描述**：核心功能，允许用户通过简单的输入和选择，快速生成多张高质量的封面候选图。

*   **输入界面**：
    *   **视频/播客标题输入框**：用户在此输入视频或播客的核心标题文本，支持多语言输入。
    *   **头像/Logo上传组件**：提供文件上传功能，支持JPG/PNG格式，用户可选择上传个人头像或品牌Logo作为生成封面的视觉元素。此项为可选，若不上传则系统使用默认人设或通用元素。
    *   **风格模板选择器**：提供预设的风格模板列表供用户选择，例如“科技感”、“生活方式”、“极简”、“卡通”、“赛博朋克”、“国潮”等。每个模板应有预览图。
*   **生成逻辑**：
    *   用户点击“生成”按钮后，前端收集所有输入参数（标题、头像/Logo URL、选定模板ID）。
    *   请求发送至后端生成服务。
    *   后端服务根据输入参数，调用AI图像生成API（如Google Vertex AI `gemini-2.5-flash-image` 或国内备用API）。
    *   AI模型根据标题内容、用户上传的视觉元素和选定的风格模板，生成3–6张不同构图和细节的封面候选图。
    *   生成过程中，前端显示加载动画或进度条。
*   **输出展示**：
    *   生成完成后，后端将候选封面图的URL或Base64数据返回给前端。
    *   前端以画廊形式展示所有候选封面图，每张图下方应有“局部编辑”和“下载”按钮。

**数据流**：
1.  用户在前端界面输入标题、上传头像/Logo（可选）、选择风格模板。
2.  前端将这些数据打包成生成请求，发送至后端API网关。
3.  API网关将请求路由至封面生成服务。
4.  封面生成服务从对象存储中获取用户上传的头像/Logo，并结合标题和模板信息，构建AI模型所需的Prompt。
5.  封面生成服务调用外部AI图像生成API（如Google Vertex AI）。
6.  AI图像生成API返回生成的图片数据。
7.  封面生成服务将生成的图片存储至对象存储（海外用户：Google Cloud Storage），并记录生成任务状态。
8.  图片存储成功后，服务将图片URL返回给前端。
9.  前端展示生成的候选封面图。

#### 4.1.3 局部编辑模块

**功能描述**：允许用户对已生成的封面图进行局部区域的精细化修改，提升满意度。

*   **区域框选工具**：
    *   用户在前端界面选择一张候选封面图进行编辑。
    *   提供矩形、圆形或自由套索工具，允许用户在图片上精确框选需要修改的区域（生成Mask）。
*   **修改指令输入**：
    *   框选区域后，出现文本输入框，用户输入具体的修改指令，例如“把背景改为咖啡馆”、“把人物表情改为惊讶”、“衣服换成蓝色T恤”等。
*   **局部渲染替换**：
    *   用户提交修改指令后，前端将原图、Mask数据和修改指令发送至后端局部编辑服务。
    *   后端服务调用AI图像编辑API（通常是Inpainting/Outpainting或特定编辑模型）。
    *   AI模型根据指令，仅对Mask区域进行图像内容替换或风格调整，保持其他区域不变。
    *   编辑完成后，返回新的图片数据给前端。
    *   前端展示编辑后的图片，并允许用户继续编辑或下载。

**数据流**：
1.  用户在前端选择一张图片，使用工具框选区域，并输入修改指令。
2.  前端将原图URL、框选区域的Mask数据和修改指令发送至后端局部编辑服务。
3.  局部编辑服务构建AI模型所需的局部编辑Prompt（包含原图、Mask和指令）。
4.  局部编辑服务调用外部AI图像编辑API。
5.  AI图像编辑API返回局部修改后的图片数据。
6.  局部编辑服务将新图片存储至对象存储，并更新任务状态。
7.  新图片URL返回给前端，前端展示编辑结果。

#### 4.1.4 下载与分享模块

**功能描述**：提供多种下载选项，并自动适配主流平台尺寸，方便用户直接使用。

*   **下载格式**：支持JPG和PNG两种图片格式下载。
*   **尺寸适配**：
    *   提供预设的平台尺寸列表供用户选择，如YouTube封面（1280x720）、B站封面（1920x1080）、抖音竖版封面（1080x1920）等。
    *   用户选择后，系统自动将图片裁剪或缩放至对应尺寸，并保持内容完整性。
*   **AI标识水印**：所有下载图片默认嵌入AI生成标识水印（如SynthID），符合合规要求。
*   **分享功能（MVP暂缓）**：未来可考虑集成社交媒体分享功能。

**数据流**：
1.  用户在前端选择一张图片，点击下载按钮。
2.  前端弹出下载选项，用户选择下载格式和目标平台尺寸。
3.  前端向后端下载服务发送下载请求，包含图片URL、目标格式和尺寸。
4.  后端下载服务从对象存储获取原始图片。
5.  后端服务根据用户选择，对图片进行格式转换、尺寸调整和水印嵌入处理。
6.  处理完成后，后端将处理后的图片数据流返回给前端。
7.  前端触发浏览器下载。

#### 4.1.5 额度与订阅模块

**功能描述**：管理用户的使用配额，并提供不同等级的订阅服务，实现商业化。

*   **免费用户**：
    *   每日生成额度：3张封面图。
    *   导出图片带有AI标识水印。
    *   导出图片为标准分辨率。
*   **Pro 用户**：
    *   月度生成额度：50张封面图。
    *   支持高清导出。
    *   导出图片带有AI标识水印。
    *   价格：$9/月。
*   **Pro+ 用户**：
    *   月度生成额度：200张封面图。
    *   支持高清导出。
    *   提供品牌模板定制功能（MVP后考虑）。
    *   支持商用授权。
    *   导出图片带有AI标识水印。
    *   价格：$19/月。
*   **订阅管理**：
    *   用户可在个人中心查看当前额度使用情况。
    *   提供订阅/升级/取消订阅的入口，引导用户至支付流程。

**数据流**：
1.  用户登录后，前端向后端用户管理服务请求当前用户额度信息。
2.  用户管理服务从用户数据库获取用户订阅状态和已使用额度，并返回给前端。
3.  每次生成或编辑图片时，前端向后端发送请求，后端在用户管理服务中扣减相应额度。
4.  额度不足时，后端返回错误信息，前端提示用户升级订阅。
5.  用户发起订阅/升级请求，前端引导至支付模块。

### 4.2 后台功能模块

#### 4.2.1 用户管理模块

**功能描述**：管理平台所有用户的信息、订阅状态和使用配额。

*   **用户注册管理**：记录新注册用户信息，包括注册时间、注册来源（邮箱/Google/微信）。
*   **订阅状态管理**：跟踪用户的订阅等级（免费/Pro/Pro+）、订阅开始/结束时间、续费状态。
*   **配额统计与调整**：实时统计用户已使用的生成/编辑额度，并支持后台手动调整用户配额。
*   **用户行为日志**：记录用户关键操作，如登录、生成、编辑、下载等。

**数据流**：
1.  用户注册/登录时，相关信息写入用户数据库（Supabase/Firebase Firestore）。
2.  用户管理后台通过API访问用户数据库，进行查询、修改操作。
3.  支付系统完成支付后，通知用户管理服务更新用户订阅状态和配额。

#### 4.2.2 任务管理模块

**功能描述**：监控和管理所有封面生成及编辑任务的生命周期。

*   **任务创建**：用户发起生成/编辑请求时，创建新的任务记录。
*   **状态追踪**：实时更新任务状态（排队中、处理中、成功、失败）。
*   **失败重试机制**：对于因外部API调用失败等可恢复性错误，支持自动重试或手动触发重试。
*   **任务队列管理**：管理待处理任务队列，确保任务按序执行，防止系统过载。

**数据流**：
1.  用户发起生成/编辑请求，封面生成/局部编辑服务将任务信息写入任务数据库（Supabase/Firebase Firestore）和消息队列（Redis）。
2.  任务处理服务从消息队列中消费任务，并更新任务状态。
3.  任务执行结果（成功/失败、图片URL）更新回任务数据库。
4.  任务管理后台通过API查询任务数据库，展示任务列表和详情。

#### 4.2.3 内容安全模块

**功能描述**：确保生成内容的合规性，过滤敏感信息，避免风险。

*   **敏感词检测**：
    *   对用户输入的标题、编辑指令进行敏感词过滤。
    *   对AI生成图片中的文字内容进行识别和敏感词检测。
    *   敏感词库需定期更新，并支持自定义扩展。
*   **人像审核**：
    *   对用户上传的头像和AI生成的人像进行合规性审核，避免非法换脸、色情、暴力等违规内容。
    *   集成第三方内容审核API或自建模型。
*   **AI标识嵌入**：所有AI生成图片默认嵌入不可擦除的AI标识水印（如SynthID），符合《生成式AI服务管理办法》和C2PA元数据链路要求。

**数据流**：
1.  用户输入文本（标题、指令）时，前端或后端在发送给AI模型前，先调用敏感词检测服务。
2.  AI生成图片后，图片数据在存储前，先经过人像审核服务。
3.  审核不通过的内容，拒绝生成或进行相应处理（如打码、删除）。
4.  AI标识嵌入在图片生成或下载处理阶段完成。

#### 4.2.4 计费与支付模块

**功能描述**：支持多区域的支付方式，实现订阅服务的计费和收款。

*   **国际支付**：
    *   集成Stripe（信用卡支付）。
    *   集成PayPal（可选）。
*   
*   **订单管理**：记录所有支付订单信息，包括订单号、金额、支付状态、支付时间、关联用户等。
*   **退款管理**：支持后台发起退款操作。

**数据流**：
1.  用户在前端选择订阅套餐，前端向后端支付服务发起支付请求。
2.  支付服务生成订单，并引导用户至第三方支付平台（Creem/PayPal/Stripe/支付宝）。
3.  用户在第三方平台完成支付。
4.  第三方支付平台通过Webhook通知后端支付服务支付结果。
5.  支付服务更新订单状态，并通知用户管理服务更新用户订阅状态和配额。
6.  支付记录存储至支付数据库。

#### 4.2.5 日志与监控模块

**功能描述**：收集系统运行日志和关键指标，用于性能分析、故障排查和成本优化。

*   **日志收集**：收集前端、后端、AI服务的所有操作日志、错误日志。
*   **性能指标监控**：
    *   **生成耗时**：统计单张封面图的平均生成时间、最大生成时间。
    *   **任务失败率**：统计生成/编辑任务的失败比例。
    *   **API成本统计**：监控各AI服务API的调用次数和预估成本。
*   **业务指标监控**：
    *   DAU（日活跃用户）、MAU（月活跃用户）。
    *   免费用户转化率、付费用户留存率。
    *   用户满意度（如保存率、下载率）。
*   **告警机制**：针对关键指标异常（如失败率过高、生成耗时过长）设置告警。

**数据流**：
1.  系统各模块（前端、后端服务、AI服务）产生日志和指标数据。
2.  日志数据通过日志收集服务（如ELK Stack）统一收集、存储和分析。
3.  指标数据通过监控系统（如Prometheus + Grafana）进行采集、可视化和告警。
4.  数据存储在日志存储和时序数据库中。

---

## 5. 技术方案 - 详细说明

### 5.1 前端技术栈

*   **框架**：Next.js / Vue3 (推荐Next.js，利于SEO和服务器端渲染)
*   **样式**：TailwindCSS (快速构建UI，响应式设计)
*   **多语言**：i18n (支持中英文，未来可扩展更多语言)
*   **交互**：
    *   **头像上传**：使用组件库（如Ant Design Upload或Element UI Upload）实现文件上传预览、进度显示。
    *   **实时预览**：图片生成或编辑后，通过WebSocket或长轮询实时更新前端图片展示。
    *   **局部编辑（Mask）**：利用HTML Canvas或第三方库（如Fabric.js, Konva.js）实现图片区域的框选和Mask生成。

### 5.2 后端技术栈

*   **API 层**：
    *   **主AI服务**：Google Vertex AI (`gemini-2.5-flash-image`)
    *   **国内Fallback**：阿里通义·万相  (通过策略模式或配置中心实现动态切换)
    *   **API 网关**：Nginx / Kong (负责请求路由、负载均衡、认证鉴权)
*   **存储**：
    *   **对象存储**：
        *   海外用户：Google Cloud Storage
        *   中国用户：阿里 OSS / 腾讯 COS
    *   **数据库**：
        *   **用户 & 任务数据**：Supabase / Firebase Firestore (NoSQL数据库，易于扩展，支持实时同步)
        *   **缓存 & 队列**：Redis (用于存储Session、任务队列、热门数据缓存)
*   **支付系统集成**：
    *   **国际**：Stripe / PayPal (通过SDK或API集成)
    *   **中国**：微信支付 / 支付宝 (通过SDK或API集成)

---

## 6. Prompt 设计示例

### 6.1 封面生成Prompt

```text
Generate a YouTube thumbnail.
Keep the same person face and hairstyle as the reference image.
Background: modern tech style, neon gradient.
Add bold, readable title text in English/Chinese.
Output size: 1280x720.
```

**详细说明**：
*   `reference image`：用户上传的头像/Logo。
*   `Background`：根据用户选择的风格模板动态生成。
*   `title text`：用户输入的视频/播客标题。
*   `Output size`：根据用户选择的平台尺寸动态调整。

### 6.2 局部编辑Prompt

```text
Edit only the background area.
Replace with a coffee shop interior, natural lighting.
Keep the person unchanged.
```

**详细说明**：
*   `background area`：用户框选的Mask区域。
*   `coffee shop interior, natural lighting`：用户输入的修改指令。
*   `Keep the person unchanged`：强调Mask区域外的内容保持不变。

---

## 7. 数据与指标

### 7.1 性能指标

*   **单张生成时间**：平均 < 10 秒 (目标：P90 < 15秒)
*   **一致性成功率**：≥ 80% (指生成图片与用户期望风格、人设一致的比例)
*   **任务失败率**：< 5% (指因系统或AI服务问题导致任务失败的比例)

### 7.2 业务指标

*   **DAU (日活跃用户)**：首月目标 500–1000
*   **免费→付费转化率**：3–5%
*   **用户满意度**：≥70% 的用户保存至少 1 张生成结果 (通过用户行为数据统计)

---

## 8. 商业模式

*   **免费增值 (Freemium)** 模式：
    *   **免费版**：每日提供 3 张标准分辨率封面生成额度，图片带AI标识水印。
    *   **Pro 版**：每月 $9，提供 50 张高清封面生成额度，图片带AI标识水印，支持高清导出。
    *   **Pro+ 版**：每月 $19，提供 200 张高清封面生成额度，图片带AI标识水印，支持商用授权，未来可提供品牌模板定制。

---

## 9. 风险与合规

*   **AI 标识**：所有AI生成图片默认嵌入SynthID水印，确保内容可追溯性。
*   **合规性**：
    *   **海外**：遵循C2PA元数据链路标准，确保AI生成内容的透明度和可信度。
    *   **中国**：严格遵守《生成式AI服务管理办法》等相关法律法规，确保服务合法合规。
*   **风险防控**：
    *   **敏感词过滤**：建立并持续更新敏感词库，对用户输入和生成内容进行实时过滤，防止涉政、涉黄、暴力等违规内容的出现。
    *   **人像检测与审核**：利用AI技术对用户上传及生成图片中的人像进行检测和审核，严防非法换脸、侵犯肖像权等行为。

---

## 10. 里程碑（MVP）

*   **第1周**：
    *   完成用户注册/登录模块开发与测试。
    *   实现基础封面生成功能（输入标题 + 模板选择）。
    *   搭建前端与后端基础通信框架。

*   **第2周**：
    *   实现局部编辑功能（区域框选 + 指令修改）。
    *   完成PNG/JPG图片下载功能，并嵌入AI标识水印。
    *   接入支付订阅系统（Stripe/微信支付/支付宝）。

*   **第3周**：
    *   集成国内AI API fallback机制，确保服务可用性。
    *   实现多语言UI切换功能。
    *   搭建日志收集与监控系统，开始收集关键性能指标。

---

## 11. 原型示意（简化）

```
[首页]
 ├─ 上传头像/Logo
 ├─ 输入标题
 ├─ 选择风格模板
 └─ [生成按钮]

[结果页]
 ├─ 6 张候选封面
 ├─ 单张 → [局部编辑] / [下载]
 └─ [升级订阅]
```

---

## 12. 数据流与系统架构概述

本节将详细描述系统的整体数据流向和主要模块间的交互关系，为后续的系统架构图提供基础。

### 12.1 核心数据流

系统的数据流主要围绕用户请求、AI生成/编辑、数据存储和结果交付展开。以下是关键数据流的概览：

1.  **用户请求流**：
    *   用户通过前端界面发起封面生成或局部编辑请求。
    *   请求包含用户输入（标题、指令）、上传文件（头像/Logo）、选择参数（风格模板、编辑区域Mask）。
    *   请求经由API网关转发至后端相应的业务服务。

2.  **AI处理流**：
    *   后端业务服务（封面生成服务、局部编辑服务）根据请求构建AI模型所需的Prompt和输入数据。
    *   服务调用外部AI图像生成/编辑API。
    *   AI API返回处理后的图片数据。

3.  **数据存储流**：
    *   用户上传的头像/Logo存储至对象存储服务。
    *   AI生成的图片存储至对象存储服务。
    *   用户数据、任务状态、订单信息等结构化数据存储至数据库。
    *   日志和监控数据流向专门的日志/监控系统。

4.  **结果交付流**：
    *   AI处理完成后，图片URL返回给前端。
    *   前端展示图片，用户可选择下载。
    *   下载请求触发后端图片处理（格式转换、尺寸适配、水印嵌入），然后将处理后的图片流返回给用户浏览器。

### 12.2 主要模块间交互

系统由多个独立但相互协作的模块组成，通过API和消息队列进行通信：

*   **前端应用**：用户交互界面，负责收集用户输入、展示结果、调用后端API。
*   **API 网关**：作为所有外部请求的统一入口，负责认证、鉴权、路由、负载均衡。
*   **认证服务**：处理用户注册、登录、Token管理。
*   **用户管理服务**：管理用户基本信息、订阅状态、配额。
*   **封面生成服务**：负责构建生成Prompt、调用AI图像生成API、处理生成结果。
*   **局部编辑服务**：负责处理局部编辑请求、构建编辑Prompt、调用AI图像编辑API。
*   **内容安全服务**：提供敏感词过滤、人像审核功能，供生成/编辑服务调用。
*   **支付服务**：处理支付请求、与第三方支付平台交互、更新订单状态。
*   **任务管理服务**：管理任务生命周期、失败重试、任务队列。
*   **对象存储**：存储用户上传文件和AI生成图片。
*   **数据库**：存储用户、任务、订单等结构化数据。
*   **消息队列 (Redis)**：用于任务异步处理、解耦服务。
*   **日志/监控系统**：收集、存储、分析系统运行日志和性能指标。

这些模块共同协作，形成一个完整的封面 & 海报生成工具系统。在下一节中，我们将基于这些详细的功能模块和数据流，绘制出视觉化的系统架构图。







